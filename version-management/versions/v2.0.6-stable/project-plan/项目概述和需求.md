# guandan-score 项目概述和需求文档

═══════════════════════════════════════════════════════════════════════════════

## 📋 项目概述

### 项目背景
guandan-score 是一款专为掼蛋游戏设计的微信小程序计分工具。掼蛋是江苏地区流行的扑克牌游戏，需要精确的计分系统来记录游戏过程。本项目的目标是提供一个简洁、高效、易用的计分工具，满足掼蛋爱好者的日常游戏需求。

### 项目目标
- **主要目标**: 提供稳定可靠的掼蛋游戏计分功能
- **次要目标**: 优化用户体验，提升小程序性能和响应速度
- **长期目标**: 建立完善的游戏数据管理系统，支持历史记录查询和统计分析

### 项目范围
- **功能范围**: 游戏计分、历史记录、数据管理、用户界面优化
- **技术范围**: 微信小程序开发、前端优化、数据存储、性能提升
- **用户范围**: 掼蛋游戏爱好者、微信用户群体

═══════════════════════════════════════════════════════════════════════════════

## 🎯 功能需求

### 核心功能模块

#### 1. 游戏计分系统
**功能描述**: 提供掼蛋游戏的计分功能
- **输入**: 玩家得分、游戏轮次、过A状态
- **输出**: 实时分数显示、等级变化提示
- **处理逻辑**: 
  - 支持红蓝双方计分
  - 自动计算等级变化
  - 过A制规则处理
  - 游戏结束判定

#### 2. 历史记录管理
**功能描述**: 记录和查询游戏历史数据
- **输入**: 游戏结果、时间戳、玩家信息
- **输出**: 历史记录列表、统计数据
- **处理逻辑**:
  - 自动保存游戏记录
  - 支持历史数据查询
  - 数据修复和验证
  - 统计信息计算

#### 3. 数据存储系统
**功能描述**: 本地数据持久化存储
- **输入**: 游戏数据、用户设置
- **输出**: 持久化存储数据
- **处理逻辑**:
  - 使用微信小程序本地存储
  - 数据备份和恢复
  - 存储空间管理
  - 数据清理机制

#### 4. 用户界面系统
**功能描述**: 提供友好的用户交互界面
- **输入**: 用户操作、触摸事件
- **输出**: 界面更新、反馈信息
- **处理逻辑**:
  - 响应式布局设计
  - 触摸交互处理
  - 状态反馈机制
  - 错误处理提示

═══════════════════════════════════════════════════════════════════════════════

## ⚡ 非功能需求

### 性能需求
- **响应时间**: 页面加载时间 < 2秒
- **操作响应**: 用户操作响应时间 < 500ms
- **内存使用**: 运行时内存占用 < 50MB
- **存储空间**: 本地存储使用 < 10MB

### 可靠性需求
- **系统稳定性**: 连续运行无崩溃
- **数据完整性**: 数据丢失率 < 0.1%
- **错误恢复**: 自动错误检测和恢复机制
- **兼容性**: 支持微信版本 8.0+

### 安全性需求
- **数据安全**: 本地数据加密存储
- **隐私保护**: 不收集用户个人信息
- **输入验证**: 所有用户输入验证和过滤
- **错误处理**: 安全的错误信息显示

### 可用性需求
- **易用性**: 新用户5分钟内掌握基本操作
- **可访问性**: 支持无障碍访问
- **多语言**: 支持中文界面
- **帮助系统**: 内置操作指南

═══════════════════════════════════════════════════════════════════════════════

## 🎨 用户界面需求

### 设计原则
- **简洁性**: 界面简洁明了，避免复杂操作
- **一致性**: 保持设计风格和交互方式一致
- **直观性**: 功能布局符合用户使用习惯
- **响应性**: 适配不同屏幕尺寸和设备

### 界面布局
- **主界面**: 计分区域居中，操作按钮分布合理
- **历史界面**: 列表式布局，支持快速浏览
- **设置界面**: 分组式布局，功能分类清晰

### 交互方式
- **触摸操作**: 支持点击、长按、滑动
- **反馈机制**: 操作后提供视觉和触觉反馈
- **状态提示**: 清晰的状态指示和进度显示
- **错误提示**: 友好的错误信息和解决建议

═══════════════════════════════════════════════════════════════════════════════

## 💾 数据需求

### 数据结构
```javascript
// 游戏数据
{
  levelTexts: Array,        // 分数等级文本
  historyScores: Array,     // 历史分数记录
  rule: String,            // 游戏规则
  maxRounds: Number,       // 最大轮次
  rounds: Number,          // 当前轮次
  aAttempts: Object,       // 过A尝试次数
  gameEnded: Boolean,      // 游戏结束状态
  players: Object          // 玩家信息
}

// 历史记录数据
{
  id: String,              // 记录ID
  timestamp: Number,       // 时间戳
  scores: Object,          // 最终分数
  rounds: Number,          // 游戏轮次
  duration: Number,        // 游戏时长
  winner: String           // 获胜方
}
```

### 存储方式
- **本地存储**: 使用微信小程序 wx.getStorageSync/wx.setStorageSync
- **存储位置**: 微信小程序本地存储空间
- **数据格式**: JSON格式存储
- **备份策略**: 定期数据备份和恢复

### 数据流
1. **数据输入**: 用户操作 → 界面事件 → 数据处理
2. **数据存储**: 处理结果 → 本地存储 → 持久化保存
3. **数据查询**: 存储数据 → 数据读取 → 界面显示
4. **数据清理**: 定期清理 → 空间释放 → 性能优化

═══════════════════════════════════════════════════════════════════════════════

## 🏗️ 系统架构

### 整体架构
```
┌─────────────────────────────────────────────────────────────┐
│                    微信小程序框架                            │
├─────────────────────────────────────────────────────────────┤
│  📁 project-plan/ (项目文档)                                 │
│  ├─ 项目概述和需求.md                                        │
│  ├─ 编程规则.md                                              │
│  ├─ 版本管理系统.md                                          │
│  └─ 其他项目文档...                                          │
├─────────────────────────────────────────────────────────────┤
│  页面层 (Pages)                                              │
│  ├─ index (主页面)                                          │
│  ├─ history (历史页面)                                      │
│  └─ team-setting (队伍设置页面)                             │
├─────────────────────────────────────────────────────────────┤
│  业务逻辑层 (Utils)                                          │
│  ├─ gameRules (游戏规则)                                    │
│  ├─ scoreLogic (计分逻辑)                                   │
│  ├─ gameData (游戏数据)                                     │
│  ├─ storageManager (存储管理)                               │
│  ├─ uiManager (界面管理)                                    │
│  ├─ envManager (环境管理)                                   │
│  ├─ helpers (辅助工具)                                      │
│  └─ imageOptimizer (图片优化)                               │
├─────────────────────────────────────────────────────────────┤
│  数据层 (Data)                                              │
│  ├─ gameConfig (游戏配置)                                   │
│  └─ localStorage (本地存储)                                 │
└─────────────────────────────────────────────────────────────┘
```

### 模块关系
- **页面层**: 负责用户界面展示和用户交互
- **业务逻辑层**: 处理核心业务逻辑和数据处理
- **数据层**: 管理配置数据和持久化存储

### 模块职责
- **GameRules**: 游戏规则验证和处理
- **ScoreLogic**: 分数计算和等级判定
- **GameData**: 游戏状态管理和数据操作
- **StorageManager**: 本地存储的读写操作
- **UIManager**: 界面状态管理和用户反馈
- **EnvManager**: 环境信息检测和管理
- **Helpers**: 通用工具函数和辅助方法
- **ImageOptimizer**: 图片资源优化和缓存管理

═══════════════════════════════════════════════════════════════════════════════

## 📊 需求优先级

### 高优先级 (P0)
- 游戏计分功能正常运行
- 数据存储和读取稳定性
- 基本用户界面可用性

### 中优先级 (P1)
- 历史记录查询功能
- 性能优化和响应速度
- 用户体验改进

### 低优先级 (P2)
- 高级统计分析功能
- 界面美化优化
- 扩展功能开发

═══════════════════════════════════════════════════════════════════════════════

📝 文档信息

**创建时间**: 2024年9月20日  
**最后更新**: 2024年9月20日  
**负责人**: Jennifer  
**状态**: 持续更新中  
**版本**: v1.0.0
