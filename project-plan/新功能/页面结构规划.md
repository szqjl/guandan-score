# 掼蛋计分小程序 - 页面结构规划

## 📱 页面层级结构

### 当前页面结构
```
pages/
├── index/              # 主页（单机版）
│   ├── index.js
│   ├── index.wxml
│   ├── index.wxss
│   └── index.json
├── history/            # 历史记录
│   ├── index.js
│   ├── index.wxml
│   ├── index.wxss
│   └── index.json
└── team-setting/       # 队伍设置
    ├── index.js
    ├── index.wxml
    ├── index.wxss
    └── index.json
```

### 新增页面结构
```
pages/
├── index/              # 主页（单机版）
├── history/            # 历史记录
├── team-setting/       # 队伍设置
├── room-create/        # 房间创建 ⭐ 新增
│   ├── index.js
│   ├── index.wxml
│   ├── index.wxss
│   └── index.json
├── room-join/          # 房间加入 ⭐ 新增
│   ├── index.js
│   ├── index.wxml
│   ├── index.wxss
│   └── index.json
├── game-multi/         # 多人游戏 ⭐ 新增
│   ├── index.js
│   ├── index.wxml
│   ├── index.wxss
│   └── index.json
└── profile/            # 个人中心 ⭐ 新增
    ├── index.js
    ├── index.wxml
    ├── index.wxss
    └── index.json
```

## 🗺️ 页面导航流程

### 单机版流程
```
主页(index) → 历史记录(history)
    ↓
队伍设置(team-setting)
```

### 多人版流程
```
主页(index) → 房间创建(room-create) → 多人游戏(game-multi)
    ↓              ↓
历史记录(history)   房间加入(room-join)
    ↓              ↓
队伍设置(team-setting) → 个人中心(profile)
```

## 📄 页面详细规划

### 1. 主页 (index) - 升级版

#### 功能定位
- **单机模式**：保持现有功能
- **多人入口**：添加多人模式入口
- **模式选择**：用户可选择单机或多人

#### 主要修改
```xml
<!-- 在右侧控制面板添加多人模式按钮 -->
<view class="right-control-panel">
  <!-- 现有按钮 -->
  <button class="start-btn" bindtap="onStartGame">开始游戏</button>
  
  <!-- 新增按钮 -->
  <button class="multi-btn" bindtap="onCreateRoom">创建房间</button>
  <button class="join-btn" bindtap="onJoinRoom">加入房间</button>
  
  <!-- 其他现有功能 -->
</view>
```

#### 新增功能
- 创建房间按钮
- 加入房间按钮
- 模式切换提示

### 2. 房间创建页面 (room-create)

#### 页面功能
- 生成房间号和二维码
- 显示玩家座位
- 房间设置和开始游戏

#### 页面结构
```xml
<view class="room-create-page">
  <!-- 头部 -->
  <view class="page-header">
    <view class="brand-logo">
      <image src="/images/GD.png" />
      <text>掼蛋计分</text>
    </view>
    <button class="back-btn" bindtap="onBack">返回</button>
  </view>
  
  <!-- 房间信息 -->
  <view class="room-info-card">
    <view class="room-number">{{roomId}}</view>
    <view class="qr-code">
      <image src="{{qrCodeUrl}}" />
    </view>
    <text class="invite-text">扫码邀请好友加入</text>
  </view>
  
  <!-- 玩家座位 -->
  <view class="players-area">
    <PlayerSeat wx:for="{{seats}}" wx:key="index" 
      seatIndex="{{index}}"
      player="{{item.player}}"
      isHost="{{item.isHost}}"
      bindreplace="onReplacePlayer"
    />
  </view>
  
  <!-- 操作按钮 -->
  <view class="action-buttons">
    <button class="start-btn" bindtap="onStartGame">开始游戏</button>
    <button class="settings-btn" bindtap="onSettings">房间设置</button>
    <button class="leave-btn" bindtap="onLeaveRoom">离开房间</button>
  </view>
</view>
```

#### 数据模型
```javascript
data: {
  roomId: '',
  qrCodeUrl: '',
  seats: [
    { player: null, isHost: false },
    { player: null, isHost: false },
    { player: null, isHost: false },
    { player: null, isHost: false }
  ],
  gameMode: 'by-A',
  maxRounds: 10,
  roomStatus: 'waiting' // waiting, playing, finished
}
```

### 3. 房间加入页面 (room-join)

#### 页面功能
- 扫码加入房间
- 手动输入房间号
- 显示加入状态

#### 页面结构
```xml
<view class="room-join-page">
  <!-- 头部 -->
  <view class="page-header">
    <view class="brand-logo">
      <image src="/images/GD.png" />
      <text>掼蛋计分</text>
    </view>
    <button class="back-btn" bindtap="onBack">返回</button>
  </view>
  
  <!-- 扫码区域 -->
  <view class="scan-area">
    <camera class="camera" bindscancode="onScanCode" />
    <view class="scan-tip">扫描房间二维码</view>
  </view>
  
  <!-- 手动输入 -->
  <view class="manual-input">
    <view class="input-label">或手动输入房间号</view>
    <input class="room-input" 
      placeholder="请输入6位房间号"
      value="{{roomId}}"
      bindinput="onRoomIdInput"
    />
    <button class="join-btn" bindtap="onJoinRoom">加入房间</button>
  </view>
  
  <!-- 状态提示 -->
  <view class="status-tip" wx:if="{{statusMessage}}">
    {{statusMessage}}
  </view>
</view>
```

### 4. 多人游戏页面 (game-multi)

#### 页面功能
- 基于现有单机版界面
- 增加多人协作功能
- 实时同步分数

#### 主要修改
```xml
<!-- 在现有基础上添加多人功能 -->
<view class="container cn-paper-bg">
  <!-- 现有品牌标识 -->
  <view class="brand-section">
    <!-- 添加房间信息显示 -->
    <view class="room-info">
      <text class="room-id">房间: {{roomId}}</text>
      <text class="player-count">{{playerCount}}/4人</text>
    </view>
  </view>
  
  <!-- 现有布局保持不变 -->
  <view class="main-layout">
    <!-- 红方和蓝方布局 -->
  </view>
  
  <!-- 现有历史表格 -->
  <view class="history-table-section">
    <!-- 历史比分表格 -->
  </view>
  
  <!-- 现有控制面板 -->
  <view class="right-control-panel">
    <!-- 现有按钮 + 多人功能按钮 -->
  </view>
</view>
```

### 5. 个人中心页面 (profile)

#### 页面功能
- 用户信息展示
- 战绩统计
- 设置管理

#### 页面结构
```xml
<view class="profile-page">
  <!-- 用户信息 -->
  <view class="user-info-card">
    <image class="avatar" src="{{userInfo.avatar}}" />
    <view class="user-details">
      <text class="nickname">{{userInfo.nickname}}</text>
      <text class="join-date">加入时间: {{userInfo.joinDate}}</text>
    </view>
  </view>
  
  <!-- 战绩统计 -->
  <view class="stats-section">
    <view class="stats-title">战绩统计</view>
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{stats.totalGames}}</text>
        <text class="stat-label">总场次</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{stats.wins}}</text>
        <text class="stat-label">胜场</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{stats.winRate}}%</text>
        <text class="stat-label">胜率</text>
      </view>
    </view>
  </view>
  
  <!-- 功能菜单 -->
  <view class="menu-section">
    <view class="menu-item" bindtap="onShowHistory">
      <text class="menu-icon">📊</text>
      <text class="menu-text">历史记录</text>
    </view>
    <view class="menu-item" bindtap="onShowSettings">
      <text class="menu-icon">⚙️</text>
      <text class="menu-text">设置</text>
    </view>
    <view class="menu-item" bindtap="onShowFeedback">
      <text class="menu-icon">💬</text>
      <text class="menu-text">反馈</text>
    </view>
  </view>
</view>
```

## 🔄 页面间数据传递

### 路由参数
```javascript
// 页面跳转示例
wx.navigateTo({
  url: `/pages/room-create/index?mode=${gameMode}&rounds=${maxRounds}`
});

wx.navigateTo({
  url: `/pages/room-join/index?roomId=${roomId}`
});

wx.navigateTo({
  url: `/pages/game-multi/index?roomId=${roomId}&playerId=${playerId}`
});
```

### 全局数据管理
```javascript
// app.js 全局数据
globalData: {
  userInfo: null,
  currentRoom: null,
  gameState: null,
  settings: {
    soundEnabled: true,
    autoSave: true
  }
}
```

### 页面数据同步
```javascript
// 使用事件总线进行页面间通信
const eventBus = {
  emit: function(event, data) {
    // 发送事件
  },
  on: function(event, callback) {
    // 监听事件
  }
};
```

## 📱 响应式适配

### 横屏模式（主要）
```css
@media screen and (orientation: landscape) {
  .room-create-page {
    flex-direction: row;
  }
  
  .players-area {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
  }
}
```

### 竖屏模式（兼容）
```css
@media screen and (orientation: portrait) {
  .room-create-page {
    flex-direction: column;
  }
  
  .players-area {
    display: flex;
    flex-direction: column;
  }
}
```

## 🧪 测试页面

### 开发测试页面
```
pages/
├── test/              # 测试页面
│   ├── components/    # 组件测试
│   ├── pages/         # 页面测试
│   └── api/           # API测试
```

### 测试用例
- 页面跳转测试
- 数据传递测试
- 组件渲染测试
- 交互功能测试

---

**页面规划版本**: v1.0  
**最后更新**: 2025-09-28  
**维护者**: Maius (前端开发助手)


