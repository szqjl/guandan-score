<!--pages/room/index.wxml-->
<view class="room-page" style="position: relative; left: 0rpx; top: 0rpx">
  <!-- æ¯”èµ›æ¨¡å¼é€‰æ‹©å™¨ - å±å¹•æœ€å·¦è¾¹ -->
  <view class="game-mode-selector"
    style="width: 133rpx; display: block; box-sizing: border-box; left: 20rpx; top: 100rpx">
    <view class="mode-title">æ¯”èµ›æ¨¡å¼</view>
    <radio-group bindchange="onRuleChange">
      <label class="mode-option">
        <radio value="by-A" checked="{{rule === 'by-A'}}" />
        <text class="mode-text">è¿‡Aåˆ¶</text>
      </label>
      <label class="mode-option">
        <radio value="by-rounds" checked="{{rule === 'by-rounds'}}" />
        <text class="mode-text">æŠŠæ•°åˆ¶</text>
      </label>
      <view wx:if="{{rule === 'by-rounds'}}" class="rounds-selector">
        <text class="rounds-display-text" bindtap="onShowRoundsPicker">{{maxRounds}}</text>
      </view>
    </radio-group>
  </view>

  <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
  <view class="room-header">
    <!-- ç”¨æˆ·ä¿¡æ¯ -->
    <view class="user-info" bindtap="onUserInfoClick"
      style="width: 142rpx; display: flex; box-sizing: border-box; height: 37rpx; position: relative; left: 23rpx; top: -2rpx">
      <button class="avatar-btn" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar"
        style="width: 50rpx; display: flex; box-sizing: border-box; left: -21rpx; top: 0rpx; position: relative; height: 48rpx">
        <image
          style="width: 38rpx; display: block; box-sizing: border-box; height: 38rpx; position: ; left: -8rpx; top: 1rpx"
          wx:if="{{userAvatar}}" src="{{userAvatar}}" class="user-avatar" />
        <text wx:else class="default-user-avatar">ğŸ‘¤</text>
      </button>
      <input class="nickname-input" value="{{userNickname}}" bindchange="onNicknameChange" placeholder="ç‚¹å‡»è®¾ç½®æ˜µç§°"
        style="margin-left: -12rpx !important; position: relative; left: -18rpx; width: 67rpx; display: block; box-sizing: border-box; top: 1rpx" />
    </view>

    <!-- å“ç‰Œæ ‡è¯† -->
    <view class="brand-header">
      <image class="main-logo" src="/images/GD.png" mode="aspectFit" />
      <text class="gd-text">GD</text>
      <text class="other-text">åŒä¸Šè®¡åˆ†</text>
    </view>

    <!-- æˆ¿é—´ä¿¡æ¯ -->
    <view class="room-info-header">
      <text class="room-title">ğŸ  {{roomId}}</text>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <view class="room-content"
    style="width: 562rpx; display: flex; box-sizing: border-box; left: 143rpx; top: 18rpx; position: relative; height: 224rpx">
    <!-- å·¦ä¾§ä¿¡æ¯å— -->


    <!-- ä¸­é—´ç‰Œæ¡Œå— -->
    <view class="center-table-block"
      style="height: 171rpx; display: flex; box-sizing: border-box; left: -2rpx; top: 8rpx; position: relative; width: 458rpx">
      <!-- äºŒç»´ç å®¹å™¨ -->
      <view class="qr-code-container">
        <view class="qr-title">æ‰«ç åŠ å…¥</view>
        <view class="qr-code">
          <image
            style="position: relative; left: -32rpx; top: -18rpx; width: -13rpx; display: inline-block; box-sizing: border-box"
            src="{{qrCodeUrl}}" mode="aspectFit" class="qr-image" />
        </view>

      </view>

      <!-- ç”¨æˆ·è¿›å…¥ä¿¡æ¯ -->
      <view class="user-entry-info"
        style="width: 94rpx; display: block; box-sizing: border-box; left: 354rpx; top: 18rpx; position: absolute">
        <view class="entry-title">ç©å®¶åŠ¨æ€</view>
        <view class="entry-list">
          <view wx:for="{{userEntries}}" wx:key="index" class="entry-item">
            <text class="entry-text">{{item}}</text>
          </view>
        </view>
      </view>

      <!-- åŒ—åº§ -->
      <view class="seat-container north-container">
        <view class="seat-label north-label">
          <text class="player-name">{{seats.north.playerName || seats.north.seatName}}</text>
          <text wx:if="{{seats.north.isHost}}" class="host-badge">æˆ¿ä¸»</text>
        </view>
        <view class="seat-toggle-icon">
          <image class="seat-icon" src="/images/man.png" mode="aspectFit" />
        </view>
      </view>

      <!-- è¥¿åº§ -->
      <view class="seat-container west-container">
        <view class="seat-label west-label">
          <text class="player-name">{{seats.west.playerName || seats.west.seatName}}</text>
          <text wx:if="{{seats.west.isHost}}" class="host-badge">æˆ¿ä¸»</text>
        </view>
        <view class="seat-toggle-icon">
          <image class="seat-icon" src="/images/man.png" mode="aspectFit" />
        </view>
      </view>

      <!-- ä¸­å¤®ç‰Œæ¡Œ -->
      <view class="poker-table"
        style="position: absolute; left: 233rpx; top: 83rpx; width: 84rpx; height: 86rpx; display: flex; box-sizing: border-box">
      </view>

      <!-- ä¸œåº§ -->
      <view class="seat-container east-container">
        <view class="seat-label east-label">
          <text class="player-name">{{seats.east.playerName || seats.east.seatName}}</text>
          <text wx:if="{{seats.east.isHost}}" class="host-badge">æˆ¿ä¸»</text>
        </view>
        <view class="seat-toggle-icon">
          <image class="seat-icon" src="/images/man.png" mode="aspectFit" />
        </view>
      </view>

      <!-- å—åº§ -->
      <view class="seat-container south-container">
        <view class="seat-label south-label">
          <text class="player-name">{{seats.south.playerName || seats.south.seatName}}</text>
          <text wx:if="{{seats.south.isHost}}" class="host-badge">æˆ¿ä¸»</text>
        </view>
        <view class="seat-toggle-icon">
          <image class="seat-icon" src="/images/man.png" mode="aspectFit" />
        </view>
      </view>
    </view>

    <!-- å³ä¾§æŒ‰é’®å— -->
    <view class="right-buttons-block">
      <button class="create-btn" bindtap="onStartGame" disabled="{{!canStartGame}}"
        style="height: 28rpx; display: flex; box-sizing: border-box; left: 0rpx; top: 0rpx">åˆ›å»º</button>
      <button class="share-btn" bindtap="onShareRoom">åˆ†äº«</button>
      <button class="close-btn" bindtap="onLeaveRoom">ç¦»å¼€</button>
    </view>
  </view>

  <!-- æŠŠæ•°é€‰æ‹©å¼¹çª— -->
  <view class="rounds-picker-modal" wx:if="{{showRoundsPicker}}">
    <view class="rounds-picker-overlay" bindtap="onCloseRoundsPicker"></view>
    <view class="rounds-picker-content">
      <view class="rounds-picker-header">
        <text class="rounds-picker-title">é€‰æ‹©æœ€å¤§æŠŠæ•°</text>
      </view>
      <view class="rounds-picker-grid">
        <view class="rounds-picker-item {{tempMaxRounds === 7 ? 'selected' : ''}}" data-value="7"
          bindtap="onSelectRounds">7æŠŠ</view>
        <view class="rounds-picker-item {{tempMaxRounds === 8 ? 'selected' : ''}}" data-value="8"
          bindtap="onSelectRounds">8æŠŠ</view>
        <view class="rounds-picker-item {{tempMaxRounds === 9 ? 'selected' : ''}}" data-value="9"
          bindtap="onSelectRounds">9æŠŠ</view>
        <view class="rounds-picker-item {{tempMaxRounds === 10 ? 'selected' : ''}}" data-value="10"
          bindtap="onSelectRounds">10æŠŠ</view>
        <view class="rounds-picker-item {{tempMaxRounds === 11 ? 'selected' : ''}}" data-value="11"
          bindtap="onSelectRounds">11æŠŠ</view>
        <view class="rounds-picker-item {{tempMaxRounds === 12 ? 'selected' : ''}}" data-value="12"
          bindtap="onSelectRounds">12æŠŠ</view>
        <view class="rounds-picker-item {{tempMaxRounds === 13 ? 'selected' : ''}}" data-value="13"
          bindtap="onSelectRounds">13æŠŠ</view>
        <view class="rounds-picker-item {{tempMaxRounds === 14 ? 'selected' : ''}}" data-value="14"
          bindtap="onSelectRounds">14æŠŠ</view>
        <view class="rounds-picker-item {{tempMaxRounds === 15 ? 'selected' : ''}}" data-value="15"
          bindtap="onSelectRounds">15æŠŠ</view>
      </view>
      <view class="rounds-picker-footer">
        <button class="rounds-picker-confirm" bindtap="onConfirmRounds">ç¡®å®š</button>
        <button class="rounds-picker-cancel" bindtap="onCloseRoundsPicker">å–æ¶ˆ</button>
      </view>
    </view>
  </view>
</view>